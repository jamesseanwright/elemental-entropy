d=new AudioContext,g=0,h=0,k=!0,l={x:400,y:240,g:0,b:75,l:!0},m=[],n=0,p=["#f60","#088"];
function q(e){e=e||{};b=!(Math.random()+.5|0),f=e.b||25,r=e.x||(b?800*Math.random():Math.random()+.5|0?800+f:0-f),b=e.y||(b?Math.random()+.5|0?480+f:0-f:Math.random()+.5|0?480-(80-80*Math.random()):80-80*Math.random());e={f:e.f,l:e.f,x:r,y:b,h:e.f?0:(400-r)/400*5,i:e.f?0:(240-b)/240*3,b:f,fill:e.f?"#00f":p[Math.random()*p.length|0],u:e.u,o:e.o,m:function(){return this.x>800+this.b+1||this.x<0-(this.b+1)||this.y>480+this.b+1||this.y<0-(this.b+1)}};m.push(e);return e}
a.onmousemove=function(e){100<e.clientX&&700>e.clientX&&(l.g=(e.clientX-800)/800*Math.PI*2+Math.PI)};t=q({f:!0,b:45,x:400,y:240});function u(e,b){return Math.sqrt((e.x-b.x)*(e.x-b.x)+(e.y-b.y)*(e.y-b.y))<e.b+b.b}function v(e,b){f=d.createOscillator();f.frequency.value=e;f.connect(d.destination);f.start(d.currentTime);f.stop(d.currentTime+b)}w();
function w(e){c.fillStyle="#000";c.fillRect(0,0,800,480);m=m.filter(function(b){return!b.j});e-n>=1500-100*h&&(q(),n=e);for(b in m)c.fillStyle=m[b].fill,c.shadowColor=m[b].fill,c.shadowBlur=100,c.beginPath(),c.arc(m[b].x,m[b].y,m[b].b,0,2*Math.PI),c.fill(),m[b].l||(m[b].x+=m[b].h,m[b].y+=m[b].i,m[b].j=m[b].m(),k&&u(t,m[b])&&(t.j=!0,k=!1,v(150,2)),k&&!m[b].s&&u(l,m[b])&&Math.atan2(m[b].y-240,m[b].x-400)>=l.g-Math.PI/4&&Math.atan2(m[b].y-240,m[b].x-400)<=l.g+Math.PI/4&&(m[b].s=!0,m[b].h=-1*m[b].h,
m[b].i=-1*m[b].i,g+=10,0===g%100&&h++,v(200,.1)));c.strokeStyle="#fff";c.beginPath();c.arc(l.x,l.y,l.b,l.g-Math.PI/4,l.g+Math.PI/4);c.stroke();c.fillStyle="#fff";c.font="26px Arial";c.fillText(g,20,40);k||c.fillText("BOOM",360,240);requestAnimationFrame(w)};
